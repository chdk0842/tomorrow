<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layouts/layout1}">
<head>
<meta charset="UTF-8">
<title>직원정보</title>
<th:block layout:fragment="script">
	<script th:inline="javascript">
		// 매장선택 시 해당 매장정보 불러옴
		$(function() {

			$('.info-sell-shop').off().on("change", function() {

				var shopId = $('.info-sell-shop').val();
				/* var shopId = $(this).val(); */
				/* console.log(shopId); */
				var url = "/admin/manage/employeeInfo/" + shopId;

				$(location).attr('href', url);
			});
		});

		// 수정 페이지 불러오기
	</script>
</th:block>
<th:block layout:fragment="css">
	<style>
.wrap {
	margin-top: 70px;
}

.emp-info-select {
	q box-shadow: 0px 3px 5px gray;
}

.emp-info-title {
	font-family: 'SEBANG_Gothic_Bold';
}

.info-table {
	width: 100%;
	table-layout: fixed;
	font-size: 0.8rem;
}

li {
	display: inline;
}
</style>
</th:block>
</head>
<body>
	<div layout:fragment="content">
		<div class="wrap">
			<div class="row my-4">
				<div class="col-lg-4">
					<select
						class="info-sell-shop form-select w-75 my-3 emp-info-select"
						th:value="${shopDto.shopId}" th:name="${shopDto.shopId}">
						<option value="">매장 선택</option>
						<th:block th:each="myShop: ${myShopList}"
							th:value="${myShop.shopDto.shopId}">
							<option
								th:selected="${shopDto.shopId} == ${myShop.shopDto.shopId}"
								th:value="${myShop.shopDto.shopId}"
								th:text="${myShop.shopDto.shopNm}"></option>
						</th:block>
					</select>
				</div>
				<div class="col-lg-4 text-center fs-1 fw-bold emp-info-title">근무자
					정보</div>
				<div class="col-lg-4"></div>
			</div>
			<!-- read -->
			<div>
					<div class="row text-center border-bottom" style="border-bottom: 1px solid rgba(0, 0, 0, 0.1)">
						<div class="col ">이름</div>
						<div class="col">전화번호</div>
						<div class="col">근무시간</div>
						<div class="col">시급</div>
						<div class="col">승인</div>
					</div>
					<div class="row text-center border-bottom" th:each="emplInfo : ${emplList}">
						<div class="fs-5 col" th:text="${emplInfo.memberFormDto.userNm}"></div>
						<div class="fs-5 col" th:text="${emplInfo.memberFormDto.pNum}"></div>
						<div class="fs-5 col" th:text="${emplInfo.partTime}"></div>
						<div class="fs-5 col" th:text="${emplInfo.timePay}"></div>
						<div class="fs-5 col" th:value="${emplInfo.workStatus}">
							<a th:if="${emplInfo.workStatus} == 1" style="cursor: pointer;" data-bs-toggle="modal" th:attr="data-bs-target=|#exampleModal${emplInfo.mapId}" href="#">승인대기</a>
							<a th:if="${emplInfo.workStatus} == 2"style="cursor: pointer;" data-bs-toggle="modal" th:attr="data-bs-target=|#exampleModal${emplInfo.mapId}" href="#">승인완료</a>
							<!-- Modal -->
							<form method="post" th:object="${updateMappingDto}" >
								<div class="modal fade" th:id="'exampleModal' + ${emplInfo.mapId}" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
								  <div class="modal-dialog">
								    <div class="modal-content">
								      <div class="modal-header">
								        <h1 class="modal-title fs-5" id="exampleModalLabel">직원 정보(시급, 근무시간) 수정</h1>
								      </div>
								      <div class="modal-body">
								          <div class="mb-3">
								            <label class="col-form-label">시급 설정:</label>
								            <input th:text="${emplInfo.timePay}" name="timePay" th:field="*{timePay}" type="text" class="form-control" th:id="'exampleModal' + ${emplInfo.mapId}" placeholder="숫자만 입력해주세요.">
								          </div>
								          <div class="mb-3">
								            <label class="col-form-label">근무시간 설정: </label>
								            <input th:text="${emplInfo.partTime}" name="partTime" th:field="*{partTime}" type="text" class="form-control" th:id="'exampleModal' + ${emplInfo.mapId}" placeholder="(예시) 09:00~18:00">
								          </div>
								      </div>
								      <div class="modal-footer">
								        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">삭제하기</button>
								        <button type="submit" th:formaction="@{'/admin/manage/employeeInfo/' + ${emplInfo.mapId} + '/update'}" class="btn btn-primary">수정 완료</button>
								      </div>
								    </div>
								  </div>
								</div>
								<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
							</form>
						</div>
					</div>
			</div>
		</div>
	</div>
</body>
</html>